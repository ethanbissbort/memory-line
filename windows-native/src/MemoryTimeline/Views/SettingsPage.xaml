<Page
    x:Class="MemoryTimeline.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <ScrollViewer>
        <StackPanel Padding="24" Spacing="24" MaxWidth="800">
            <!-- Header -->
            <StackPanel Spacing="8">
                <TextBlock Text="Settings"
                          Style="{StaticResource TitleTextBlockStyle}"/>
                <TextBlock Text="Configure your Memory Timeline experience"
                          Style="{StaticResource BodyTextBlockStyle}"
                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
            </StackPanel>

            <!-- Appearance Section -->
            <StackPanel Spacing="16"
                       Padding="16"
                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                       BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                       BorderThickness="1"
                       CornerRadius="8">
                <TextBlock Text="Appearance"
                          Style="{StaticResource SubtitleTextBlockStyle}"/>

                <StackPanel Spacing="8">
                    <TextBlock Text="Theme"
                              Style="{StaticResource BodyTextBlockStyle}"/>
                    <ComboBox x:Name="ThemeComboBox"
                             ItemsSource="{x:Bind ViewModel.ThemeOptions}"
                             SelectedItem="{x:Bind ViewModel.SelectedTheme, Mode=TwoWay}"
                             HorizontalAlignment="Stretch"
                             PlaceholderText="Select theme"/>
                    <TextBlock Text="Choose your preferred color theme"
                              Style="{StaticResource CaptionTextBlockStyle}"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>
            </StackPanel>

            <!-- Timeline Section -->
            <StackPanel Spacing="16"
                       Padding="16"
                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                       BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                       BorderThickness="1"
                       CornerRadius="8">
                <TextBlock Text="Timeline"
                          Style="{StaticResource SubtitleTextBlockStyle}"/>

                <StackPanel Spacing="8">
                    <TextBlock Text="Default Zoom Level"
                              Style="{StaticResource BodyTextBlockStyle}"/>
                    <ComboBox x:Name="ZoomLevelComboBox"
                             ItemsSource="{x:Bind ViewModel.ZoomLevelOptions}"
                             SelectedItem="{x:Bind ViewModel.SelectedZoomLevel, Mode=TwoWay}"
                             HorizontalAlignment="Stretch"
                             PlaceholderText="Select zoom level"/>
                    <TextBlock Text="Initial zoom level when viewing the timeline"
                              Style="{StaticResource CaptionTextBlockStyle}"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>
            </StackPanel>

            <!-- AI/LLM Section -->
            <StackPanel Spacing="16"
                       Padding="16"
                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                       BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                       BorderThickness="1"
                       CornerRadius="8">
                <TextBlock Text="AI &amp; Language Models"
                          Style="{StaticResource SubtitleTextBlockStyle}"/>

                <StackPanel Spacing="8">
                    <TextBlock Text="LLM Provider"
                              Style="{StaticResource BodyTextBlockStyle}"/>
                    <ComboBox x:Name="LlmProviderComboBox"
                             ItemsSource="{x:Bind ViewModel.LlmProviderOptions}"
                             SelectedItem="{x:Bind ViewModel.LlmProvider, Mode=TwoWay}"
                             HorizontalAlignment="Stretch"
                             PlaceholderText="Select provider"/>
                </StackPanel>

                <StackPanel Spacing="8">
                    <TextBlock Text="Model"
                              Style="{StaticResource BodyTextBlockStyle}"/>
                    <TextBox Text="{x:Bind ViewModel.LlmModel, Mode=TwoWay}"
                            PlaceholderText="Enter model name"
                            HorizontalAlignment="Stretch"/>
                    <TextBlock Text="Specific model version to use for event extraction"
                              Style="{StaticResource CaptionTextBlockStyle}"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>

                <StackPanel Spacing="8">
                    <TextBlock Text="API Key"
                              Style="{StaticResource BodyTextBlockStyle}"/>
                    <PasswordBox x:Name="ApiKeyBox"
                                Password="{x:Bind ViewModel.ApiKey, Mode=TwoWay}"
                                PlaceholderText="Enter API key"
                                HorizontalAlignment="Stretch"/>
                    <TextBlock Text="Your API key will be stored securely"
                              Style="{StaticResource CaptionTextBlockStyle}"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>
            </StackPanel>

            <!-- Audio Section -->
            <StackPanel Spacing="16"
                       Padding="16"
                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                       BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                       BorderThickness="1"
                       CornerRadius="8">
                <TextBlock Text="Audio Recording"
                          Style="{StaticResource SubtitleTextBlockStyle}"/>

                <StackPanel Spacing="8">
                    <TextBlock Text="Sample Rate (Hz)"
                              Style="{StaticResource BodyTextBlockStyle}"/>
                    <NumberBox Value="{x:Bind ViewModel.AudioSampleRate, Mode=TwoWay}"
                              Minimum="8000"
                              Maximum="48000"
                              SpinButtonPlacementMode="Inline"
                              HorizontalAlignment="Stretch"/>
                    <TextBlock Text="Higher sample rates provide better quality but larger files"
                              Style="{StaticResource CaptionTextBlockStyle}"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>

                <StackPanel Spacing="8">
                    <TextBlock Text="Bits Per Sample"
                              Style="{StaticResource BodyTextBlockStyle}"/>
                    <NumberBox Value="{x:Bind ViewModel.AudioBitsPerSample, Mode=TwoWay}"
                              Minimum="8"
                              Maximum="32"
                              SpinButtonPlacementMode="Inline"
                              HorizontalAlignment="Stretch"/>
                    <TextBlock Text="Audio bit depth (8, 16, 24, or 32 bits)"
                              Style="{StaticResource CaptionTextBlockStyle}"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>
            </StackPanel>

            <!-- Export/Import Section -->
            <StackPanel Spacing="16"
                       Padding="16"
                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                       BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                       BorderThickness="1"
                       CornerRadius="8">
                <TextBlock Text="Export &amp; Import"
                          Style="{StaticResource SubtitleTextBlockStyle}"/>

                <TextBlock Text="Export your timeline data to different formats"
                          Style="{StaticResource BodyTextBlockStyle}"
                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>

                <!-- Export Buttons -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.ColumnSpacing>8</Grid.ColumnSpacing>

                    <Button Grid.Column="0"
                           Command="{x:Bind ViewModel.ExportToJsonCommand}"
                           HorizontalAlignment="Stretch"
                           IsEnabled="{x:Bind ViewModel.IsExporting, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}">
                        <StackPanel Spacing="4">
                            <FontIcon Glyph="&#xE8B7;" FontSize="20"/>
                            <TextBlock Text="Export JSON" Style="{StaticResource CaptionTextBlockStyle}"/>
                        </StackPanel>
                    </Button>

                    <Button Grid.Column="1"
                           Command="{x:Bind ViewModel.ExportToCsvCommand}"
                           HorizontalAlignment="Stretch"
                           IsEnabled="{x:Bind ViewModel.IsExporting, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}">
                        <StackPanel Spacing="4">
                            <FontIcon Glyph="&#xE8A5;" FontSize="20"/>
                            <TextBlock Text="Export CSV" Style="{StaticResource CaptionTextBlockStyle}"/>
                        </StackPanel>
                    </Button>

                    <Button Grid.Column="2"
                           Command="{x:Bind ViewModel.ExportToMarkdownCommand}"
                           HorizontalAlignment="Stretch"
                           IsEnabled="{x:Bind ViewModel.IsExporting, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}">
                        <StackPanel Spacing="4">
                            <FontIcon Glyph="&#xE8A4;" FontSize="20"/>
                            <TextBlock Text="Export MD" Style="{StaticResource CaptionTextBlockStyle}"/>
                        </StackPanel>
                    </Button>
                </Grid>

                <!-- Export Status -->
                <StackPanel Spacing="4" Visibility="{x:Bind ViewModel.IsExporting, Mode=OneWay}">
                    <ProgressBar Value="{x:Bind ViewModel.ExportProgress, Mode=OneWay}"
                                Maximum="100"
                                IsIndeterminate="{x:Bind ViewModel.IsExporting, Mode=OneWay}"/>
                    <TextBlock Text="{x:Bind ViewModel.ExportStatusMessage, Mode=OneWay}"
                              Style="{StaticResource CaptionTextBlockStyle}"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>

                <Border Height="1"
                       Background="{ThemeResource DividerStrokeColorDefaultBrush}"
                       Margin="0,8"/>

                <!-- Import Section -->
                <TextBlock Text="Import timeline data from JSON"
                          Style="{StaticResource BodyTextBlockStyle}"
                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>

                <Button Command="{x:Bind ViewModel.ImportFromJsonCommand}"
                       HorizontalAlignment="Stretch"
                       IsEnabled="{x:Bind ViewModel.IsImporting, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <FontIcon Glyph="&#xE8B5;" FontSize="16"/>
                        <TextBlock Text="Import from JSON"/>
                    </StackPanel>
                </Button>

                <!-- Import Status -->
                <StackPanel Spacing="4" Visibility="{x:Bind ViewModel.IsImporting, Mode=OneWay}">
                    <ProgressRing IsActive="{x:Bind ViewModel.IsImporting, Mode=OneWay}"
                                 Width="24" Height="24"/>
                    <TextBlock Text="{x:Bind ViewModel.ImportStatusMessage, Mode=OneWay}"
                              Style="{StaticResource CaptionTextBlockStyle}"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>
            </StackPanel>

            <!-- Data Management Section -->
            <StackPanel Spacing="16"
                       Padding="16"
                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                       BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                       BorderThickness="1"
                       CornerRadius="8">
                <TextBlock Text="Data Management"
                          Style="{StaticResource SubtitleTextBlockStyle}"/>

                <Button Content="Clear Cache"
                       Command="{x:Bind ViewModel.ClearCacheCommand}"
                       HorizontalAlignment="Stretch">
                    <Button.Content>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE74D;" FontSize="16"/>
                            <TextBlock Text="Clear Cache"/>
                        </StackPanel>
                    </Button.Content>
                </Button>

                <Button Content="Reset to Defaults"
                       Command="{x:Bind ViewModel.ResetSettingsCommand}"
                       HorizontalAlignment="Stretch">
                    <Button.Content>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE777;" FontSize="16"/>
                            <TextBlock Text="Reset to Defaults"/>
                        </StackPanel>
                    </Button.Content>
                </Button>
            </StackPanel>

            <!-- About Section -->
            <StackPanel Spacing="16"
                       Padding="16"
                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                       BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                       BorderThickness="1"
                       CornerRadius="8">
                <TextBlock Text="About"
                          Style="{StaticResource SubtitleTextBlockStyle}"/>

                <StackPanel Spacing="4">
                    <TextBlock Text="{x:Bind ViewModel.AppName}"
                              Style="{StaticResource BodyTextBlockStyle}"
                              FontWeight="SemiBold"/>
                    <TextBlock Style="{StaticResource CaptionTextBlockStyle}"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}">
                        <Run Text="Version:"/>
                        <Run Text="{x:Bind ViewModel.AppVersion}"/>
                    </TextBlock>
                    <TextBlock Style="{StaticResource CaptionTextBlockStyle}"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}">
                        <Run Text="Build Date:"/>
                        <Run Text="{x:Bind ViewModel.BuildDate}"/>
                    </TextBlock>
                </StackPanel>

                <TextBlock Text="A personal memory timeline application powered by AI"
                          Style="{StaticResource CaptionTextBlockStyle}"
                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                          TextWrapping="Wrap"/>
            </StackPanel>

            <!-- Action Bar -->
            <Grid Padding="0,16,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                          Text="{x:Bind ViewModel.StatusMessage, Mode=OneWay}"
                          VerticalAlignment="Center"
                          Style="{StaticResource BodyTextBlockStyle}"
                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>

                <Button Grid.Column="1"
                       Content="Save Settings"
                       Command="{x:Bind ViewModel.SaveSettingsCommand}"
                       Style="{StaticResource AccentButtonStyle}"
                       MinWidth="120">
                    <Button.Content>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <ProgressRing IsActive="{x:Bind ViewModel.IsSaving, Mode=OneWay}"
                                         Width="16" Height="16"
                                         Visibility="{x:Bind ViewModel.IsSaving, Mode=OneWay}"/>
                            <TextBlock Text="Save Settings"/>
                        </StackPanel>
                    </Button.Content>
                </Button>
            </Grid>
        </StackPanel>
    </ScrollViewer>
</Page>
